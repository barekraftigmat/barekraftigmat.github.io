
		/*
 * Copyright (C) 2007 Trivantis Corporation
 */

	
function load(){updateVars();};function updateVars(){debugOpener=window.opener.opener;if(debugOpener.frames&&debugOpener.frames[0]&&debugOpener.frames[0].document.title.toString().indexOf("Title Manager")==0){titleMgr=debugOpener.frames[1].getTitleMgrHandle();if(debugOpener.frames&&debugOpener.frames[1]&&debugOpener.frames[1].frames) debugOpener=debugOpener.frames[1];};var A=0;if(titleMgr) A=titleMgr.getNumVariables();else A=getNumVars();var B=document.getElementById('varView');var C='<div id="varView" align="center"><br />';C+='<table cellpadding="5px">';for(var i=0;i<A;i++){var D;D=findVariableInOpener(i);if(!D){C+='<tr><td>'+titleMgr.getVariableNameAt(i)+'</td><td><input type="text" disabled="true" name="e  '+titleMgr.getVariableNameAt(i)+'" id="e'+titleMgr.getVariableNameAt(i)+'" value="'+titleMgr.getVariableValueAt(i)+'" size="20"';C+='></td><td>';C+='</td></tr>';}else{C+='<tr><td>'+D.name+'</td><td><input type="text" name="e'+D.name+'" id="e'+D.name+'" value="'+D.getValue()+'" size="20"';C+='></td><td>';C+='<input type="button" name="b'+D.name+'" id="b'+D.name+'" value='+trivstrUpdate+' onClick=javascript:findVariableInOpener('+i+').set(document.getElementById(\'e'+D.name+'\').value);></td></tr>';}};C+='</table></div>';B.innerHTML=C;};function getNumVars(){numVars=0;if(debugOpener.frames&&debugOpener.frames.length){for(currFrame=0;currFrame<debugOpener.frames.length;currFrame++){theFrame=debugOpener.frames[currFrame];if(theFrame.arrOfVars) numVars+=theFrame.arrOfVars.length;if(theFrame.newWnd&&!theFrame.newWnd.closed&&theFrame.newWnd.arrOfVars) numVars+=theFrame.newWnd.arrOfVars.length;}}else{if(debugOpener.arrOfVars) numVars+=debugOpener.arrOfVars.length;if(debugOpener.newWnd&&!debugOpener.newWnd.closed&&debugOpener.newWnd.arrOfVars) numVars+=debugOpener.newWnd.arrOfVars.length;};return numVars;};function findVariableInPage(A,B) {try{if(titleMgr) return eval(A+titleMgr.getVariableNameAt(B));else if(eval(A+'arrOfVars')&&B<eval(A+'arrOfVars.length')) return eval(A+'arrOfVars['+B+']');else return null;}catch(err){return null;}};function findVariableInOpener(A){v=null;if(debugOpener.frames&&debugOpener.frames.length){for(var B=0;B<debugOpener.frames.length&&!v;B++){v=null;var C='debugOpener.frames['+B+'].';v=findVariableInPage(C,A);if(eval(C+'arrOfVars')) A-=eval(C+'arrOfVars.length');while(!v&&eval(C+'newWnd')){C+='newWnd.';v=findVariableInPage(C,A);if(eval(C+'arrOfVars')) A-=eval(C+'arrOfVars.length');}}}else{v=null;var C='debugOpener.';v=findVariableInPage(C,A);if(eval(C+'arrOfVars')) A-=eval(C+'arrOfVars.length');while(!v&&eval(C+'newWnd')){C+='newWnd.';v=findVariableInPage(C,A);if(eval(C+'arrOfVars')) A-=eval(C+'arrOfVars.length');}};return v;};
